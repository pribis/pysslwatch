	
server {
  listen 443 ssl;
  http2 on; 
#  server_name 	 stage.dashboard.bxp.cc stage2.dashboard.bxp.cc dashboard.bxp.cc;
  server_name 	 dashboard.bxp.cc;
  root		/home/harold/dashboard/dashboard-front/public;
  access_log	/home/harold/dashboard/dashboard-front/logs/access.log  main;
  error_log	/home/harold/dashboard/dashboard-front/logs/error.log;
  client_max_body_size 0;	
  userid         on;
  userid_name    dashboard_bxcp;
  userid_domain  stage.dashboard.bxp.cc;
  userid_path    /;
  userid_expires 365d;
  keepalive_timeout 70;
  index index.html index.php;
    ssl_certificate /etc/letsencrypt/live/dashboard.bxp.cc/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/dashboard.bxp.cc/privkey.pem; # managed by Certbot

    #  auth_basic     "Restricted";
    # auth_basic_user_file auth/stage;


#    if ($host = stage.dashboard.bxp.cc) {
#        return 301 https://dashboard.bxp.cc$request_uri;
#    } 




   location ~ ^/.well-known/acme-challenge(.*) {
       allow all;				
       alias /var/www/certbot/.well-known/acme-challenge$1;
   }
			    
    location ~ /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }


    
    location / {
        try_files $uri $uri/ /index.html;
    }


  location  ~* \.(?:ico|css|js|gif|jpe?g|png)$ {
        expires max;
        add_header Pragma public;
        add_header Cache-Control "public, must-revalidate,proxy-revalidate";
    }

  location ~ (\.php|php5-fpm-status) {
    fastcgi_pass            php-fpm;
    fastcgi_keep_conn       on;
    fastcgi_index           index.php;
    #fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    #include fastcgi_params;

  }




}

server {
    listen 80;
    listen 443 ssl;
    server_name stage.dashboard.bxp.cc stage2.dashboard.bxp.cc;
    return 301 https://dashboard.bxp.cc$request_uri;
    return 404; # managed by Certbot

}
